import javax.swing.*
import org.freeplane.core.ui.components.UITools
import groovy.time.*
import java.util.Timer
import org.freeplane.core.util.HtmlUtils
import java.util.regex.Matcher
import java.util.regex.Pattern
import java.awt.KeyboardFocusManager 	
import java.awt.datatransfer.*
import java.awt.Toolkit
import javax.swing.JEditorPane 			
import java.text.DateFormat
import java.text.SimpleDateFormat
import java.util.Calendar
import java.util.Locale
import java.util.TimeZone
import org.freeplane.core.util.LogUtils



//===================================================================
// PURPOSE: pastes fixed size HTML table to focus note cursor position
//===================================================================	

sMARK = "CursorPos"
cCRLF = System.getProperty("line.separator")  		// assures correct CR/LF usage
sEMPTY_HTML_LINE ="<p>"+cCRLF+"</p>"+cCRLF
sTABLE_3_x_8_TEMPLATE = sEMPTY_HTML_LINE + "<table border=\"0\" style=\"width: 80%; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-width: 0; border-right-width: 0; border-bottom-width: 0; border-left-width: 0\">"+cCRLF+"      <tr>"+cCRLF+"        <td valign=\"top\" style=\"width: 33%; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-width: 1; border-right-width: 1; border-bottom-width: 1; border-left-width: 1\">"+cCRLF+"          <p style=\"margin-top: 1; margin-right: 1; margin-bottom: 1; margin-left: 1\">"+cCRLF+"            "+cCRLF+"          </p>"+cCRLF+"        </td>"+cCRLF+"        <td valign=\"top\" style=\"width: 33%; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-width: 1; border-right-width: 1; border-bottom-width: 1; border-left-width: 1\">"+cCRLF+"          <p style=\"margin-top: 1; margin-right: 1; margin-bottom: 1; margin-left: 1\">"+cCRLF+"            "+cCRLF+"          </p>"+cCRLF+"        </td>"+cCRLF+"        <td valign=\"top\" style=\"width: 33%; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-width: 1; border-right-width: 1; border-bottom-width: 1; border-left-width: 1\">"+cCRLF+"          <p style=\"margin-top: 1; margin-right: 1; margin-bottom: 1; margin-left: 1\">"+cCRLF+"            "+cCRLF+"          </p>"+cCRLF+"        </td>"+cCRLF+"      </tr>"+cCRLF+"      <tr>"+cCRLF+"        <td valign=\"top\" style=\"width: 33%; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-width: 1; border-right-width: 1; border-bottom-width: 1; border-left-width: 1\">"+cCRLF+"          <p style=\"margin-top: 1; margin-right: 1; margin-bottom: 1; margin-left: 1\">"+cCRLF+"            "+cCRLF+"          </p>"+cCRLF+"        </td>"+cCRLF+"        <td valign=\"top\" style=\"width: 33%; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-width: 1; border-right-width: 1; border-bottom-width: 1; border-left-width: 1\">"+cCRLF+"          <p style=\"margin-top: 1; margin-right: 1; margin-bottom: 1; margin-left: 1\">"+cCRLF+"            "+cCRLF+"          </p>"+cCRLF+"        </td>"+cCRLF+"        <td valign=\"top\" style=\"width: 33%; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-width: 1; border-right-width: 1; border-bottom-width: 1; border-left-width: 1\">"+cCRLF+"          <p style=\"margin-top: 1; margin-right: 1; margin-bottom: 1; margin-left: 1\">"+cCRLF+"            "+cCRLF+"          </p>"+cCRLF+"        </td>"+cCRLF+"      </tr>"+cCRLF+"      <tr>"+cCRLF+"        <td valign=\"top\" style=\"width: 33%; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-width: 1; border-right-width: 1; border-bottom-width: 1; border-left-width: 1\">"+cCRLF+"          <p style=\"margin-top: 1; margin-right: 1; margin-bottom: 1; margin-left: 1\">"+cCRLF+"            "+cCRLF+"          </p>"+cCRLF+"        </td>"+cCRLF+"        <td valign=\"top\" style=\"width: 33%; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-width: 1; border-right-width: 1; border-bottom-width: 1; border-left-width: 1\">"+cCRLF+"          <p style=\"margin-top: 1; margin-right: 1; margin-bottom: 1; margin-left: 1\">"+cCRLF+"            "+cCRLF+"          </p>"+cCRLF+"        </td>"+cCRLF+"        <td valign=\"top\" style=\"width: 33%; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-width: 1; border-right-width: 1; border-bottom-width: 1; border-left-width: 1\">"+cCRLF+"          <p style=\"margin-top: 1; margin-right: 1; margin-bottom: 1; margin-left: 1\">"+cCRLF+"            "+cCRLF+"          </p>"+cCRLF+"        </td>"+cCRLF+"      </tr>"+cCRLF+"      <tr>"+cCRLF+"        <td valign=\"top\" style=\"width: 33%; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-width: 1; border-right-width: 1; border-bottom-width: 1; border-left-width: 1\">"+cCRLF+"          <p style=\"margin-top: 1; margin-right: 1; margin-bottom: 1; margin-left: 1\">"+cCRLF+"            "+cCRLF+"          </p>"+cCRLF+"        </td>"+cCRLF+"        <td valign=\"top\" style=\"width: 33%; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-width: 1; border-right-width: 1; border-bottom-width: 1; border-left-width: 1\">"+cCRLF+"          <p style=\"margin-top: 1; margin-right: 1; margin-bottom: 1; margin-left: 1\">"+cCRLF+"            "+cCRLF+"          </p>"+cCRLF+"        </td>"+cCRLF+"        <td valign=\"top\" style=\"width: 33%; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-width: 1; border-right-width: 1; border-bottom-width: 1; border-left-width: 1\">"+cCRLF+"          <p style=\"margin-top: 1; margin-right: 1; margin-bottom: 1; margin-left: 1\">"+cCRLF+"            "+cCRLF+"          </p>"+cCRLF+"        </td>"+cCRLF+"      </tr>"+cCRLF+"      <tr>"+cCRLF+"        <td valign=\"top\" style=\"width: 33%; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-width: 1; border-right-width: 1; border-bottom-width: 1; border-left-width: 1\">"+cCRLF+"          <p style=\"margin-top: 1; margin-right: 1; margin-bottom: 1; margin-left: 1\">"+cCRLF+"            "+cCRLF+"          </p>"+cCRLF+"        </td>"+cCRLF+"        <td valign=\"top\" style=\"width: 33%; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-width: 1; border-right-width: 1; border-bottom-width: 1; border-left-width: 1\">"+cCRLF+"          <p style=\"margin-top: 1; margin-right: 1; margin-bottom: 1; margin-left: 1\">"+cCRLF+"            "+cCRLF+"          </p>"+cCRLF+"        </td>"+cCRLF+"        <td valign=\"top\" style=\"width: 33%; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-width: 1; border-right-width: 1; border-bottom-width: 1; border-left-width: 1\">"+cCRLF+"          <p style=\"margin-top: 1; margin-right: 1; margin-bottom: 1; margin-left: 1\">"+cCRLF+"            "+cCRLF+"          </p>"+cCRLF+"        </td>"+cCRLF+"      </tr>"+cCRLF+"      <tr>"+cCRLF+"        <td valign=\"top\" style=\"width: 33%; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-width: 1; border-right-width: 1; border-bottom-width: 1; border-left-width: 1\">"+cCRLF+"          <p style=\"margin-top: 1; margin-right: 1; margin-bottom: 1; margin-left: 1\">"+cCRLF+"            "+cCRLF+"          </p>"+cCRLF+"        </td>"+cCRLF+"        <td valign=\"top\" style=\"width: 33%; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-width: 1; border-right-width: 1; border-bottom-width: 1; border-left-width: 1\">"+cCRLF+"          <p style=\"margin-top: 1; margin-right: 1; margin-bottom: 1; margin-left: 1\">"+cCRLF+"            "+cCRLF+"          </p>"+cCRLF+"        </td>"+cCRLF+"        <td valign=\"top\" style=\"width: 33%; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-width: 1; border-right-width: 1; border-bottom-width: 1; border-left-width: 1\">"+cCRLF+"          <p style=\"margin-top: 1; margin-right: 1; margin-bottom: 1; margin-left: 1\">"+cCRLF+"            "+cCRLF+"          </p>"+cCRLF+"        </td>"+cCRLF+"      </tr>"+cCRLF+"      <tr>"+cCRLF+"        <td valign=\"top\" style=\"width: 33%; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-width: 1; border-right-width: 1; border-bottom-width: 1; border-left-width: 1\">"+cCRLF+"          <p style=\"margin-top: 1; margin-right: 1; margin-bottom: 1; margin-left: 1\">"+cCRLF+"            "+cCRLF+"          </p>"+cCRLF+"        </td>"+cCRLF+"        <td valign=\"top\" style=\"width: 33%; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-width: 1; border-right-width: 1; border-bottom-width: 1; border-left-width: 1\">"+cCRLF+"          <p style=\"margin-top: 1; margin-right: 1; margin-bottom: 1; margin-left: 1\">"+cCRLF+"            "+cCRLF+"          </p>"+cCRLF+"        </td>"+cCRLF+"        <td valign=\"top\" style=\"width: 33%; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-width: 1; border-right-width: 1; border-bottom-width: 1; border-left-width: 1\">"+cCRLF+"          <p style=\"margin-top: 1; margin-right: 1; margin-bottom: 1; margin-left: 1\">"+cCRLF+"            "+cCRLF+"          </p>"+cCRLF+"        </td>"+cCRLF+"      </tr>"+cCRLF+"      <tr>"+cCRLF+"        <td valign=\"top\" style=\"width: 33%; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-width: 1; border-right-width: 1; border-bottom-width: 1; border-left-width: 1\">"+cCRLF+"          <p style=\"margin-top: 1; margin-right: 1; margin-bottom: 1; margin-left: 1\">"+cCRLF+"            "+cCRLF+"          </p>"+cCRLF+"        </td>"+cCRLF+"        <td valign=\"top\" style=\"width: 33%; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-width: 1; border-right-width: 1; border-bottom-width: 1; border-left-width: 1\">"+cCRLF+"          <p style=\"margin-top: 1; margin-right: 1; margin-bottom: 1; margin-left: 1\">"+cCRLF+"            "+cCRLF+"          </p>"+cCRLF+"        </td>"+cCRLF+"        <td valign=\"top\" style=\"width: 33%; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-width: 1; border-right-width: 1; border-bottom-width: 1; border-left-width: 1\">"+cCRLF+"          <p style=\"margin-top: 1; margin-right: 1; margin-bottom: 1; margin-left: 1\">"+cCRLF+"            "+cCRLF+"          </p>"+cCRLF+"        </td>"+cCRLF+"      </tr>"+cCRLF+"    </table>" + sEMPTY_HTML_LINE

// TODO: create sTABLE_3_x_3_TEMPLATE

// TODO: create sTABLE_2_x_3_TEMPLATE

sHtmlText = sTABLE_3_x_8_TEMPLATE

//============================================================================================
// !: very fast and compact sequence to insert HTML block into node note cursor position
//--------------------------------------------------------------------------------------------
JEditorPane oFocusEditorPane = KeyboardFocusManager.currentKeyboardFocusManager.focusOwner
oFocusEditorPane.getDocument().insertString(oFocusEditorPane.getCaretPosition(),sMARK, null)
oFocusEditorPane.text = oFocusEditorPane.text.replaceAll(sMARK,sHtmlText)







